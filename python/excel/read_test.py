import pandas as pd
import traceback

import pymysql
# 打开数据库连接
db = pymysql.connect(
    host="10.2.10.17",
    user="root",
    password="4CbPsJJo",
    database="unisp",
    port=3307,
    charset='utf8'
)

asn_dict = {}
for index in range(20):
    df = pd.read_excel('test.xlsx', sheet_name=index)
    for i in range(len(df)):
        asn_dict[int(df.values[i, 0])] = df.values[i, 1]

cursor = db.cursor()
asn_info = {560:136188,561:4788,562:18403,563:138449,564:58504,565:7545,566:18004,567:140220,568:137239,569:41466,570:139584,571:136255,572:135632,573:59003,574:9299,575:135523,576:4515,577:7438,578:4764,579:58466,580:45543,581:38794,582:17547,583:23688,584:7602,585:134763,586:140594,587:17072,588:7992,589:23673,590:9298,591:23752,592:138926,593:141031,594:17897,595:7713,596:56292,597:8151,598:131090,599:56015,600:45918,601:133798,602:10226,603:133612,604:45622,605:7470,606:138388,607:134774,608:45499,609:23840,610:17924,611:58519,612:133776,613:6327,614:38264,615:38283,616:22995,617:55821,618:9341,619:23607,620:137996,621:55699,622:38819,623:134707,624:58571,625:139018,626:45245,627:16960,628:134765,629:142552,630:137226,631:131207,632:4816,633:135478,634:17421,635:58520,636:38623,637:141047,638:45727,639:11427,640:209,641:134762,642:23674,643:134840,644:140499,645:23700,646:38380,647:9506,648:137693,649:18053,650:134764,651:9500,652:133481,653:131471,654:38027,655:45558,656:9927,657:9401,658:131325,659:131591,660:137689,661:9658,662:147315,663:17633,664:138965,665:56167,666:19108,667:59050,668:9937,669:30036,670:141023,671:142150,672:38235,673:17501,674:24157,675:139398,676:10139,677:134771,678:38710,679:42962,680:135582,681:9873,682:58518,683:28509,684:45903,685:132153,686:131445,687:10118,688:133384,689:13999,690:63835,691:24389,692:132148,693:131267,694:134739,695:134766,696:45629,697:4771,698:142127,699:133731,700:24164,701:135607,702:133414,703:17557,704:134769,705:138910,706:58563,707:137698,708:17638,709:137699,710:45754,711:56262,712:9930,713:4813,714:136525,715:59010,716:133775,717:23969,718:136929,719:45925,720:45960,721:9304,722:20001,723:58895,724:137872,725:134238,726:141767,727:7018,728:21928,729:45058,730:131596,731:138432,732:38322,733:9988,734:136200,735:134489,736:132618,737:45773,738:4818,739:134788,740:38193,741:63889,742:9534,743:134756,744:24499,745:139034,746:141212,747:133623,748:132061,749:136193,750:140045,751:139201,752:9269,753:17451,754:4808,755:56099,756:56019,757:133613,758:24158,759:56003,760:852,761:4780,762:134768,763:131627,764:22884,765:138655,766:11260,767:803,768:7552,769:58517,770:24337,771:9790,772:137687,773:265540,774:133372,775:36678,776:136195,777:132165,778:4760,779:17966,780:4007,781:146998,782:136192,783:45669,784:132147,785:20057,786:11888,787:10030,788:4804,789:38841,790:701,791:24137,792:147018,793:22394,794:139088,795:24020,796:577,797:23693,798:141342,799:136167,800:23650,801:38466,802:38565,803:141432,804:23750,805:135594,806:11290,807:134117,808:140608,809:133334,810:45143,811:137692,812:58540,813:133955,814:38616,815:56300,816:137080,817:139831,818:58542,819:38553,820:28403,821:18106,822:4657,823:4837,824:4775,825:9876,826:132021,827:140732,828:4812,829:4773,830:33363,831:23944,832:6167,833:9416,834:135345,835:134770,836:55971,837:63527,838:140243,839:58860,840:134419,841:63838,842:55430,843:139351,844:135407,845:134420,846:140579,847:9231,848:138950,849:17639,850:4835,851:55501,852:141361,853:55850,854:40676,855:139922,856:4761,857:45839,858:12271,859:45498,860:135025,861:142300,862:147066,863:11351,864:134772,865:24151,866:24550,867:9443,868:812,869:56120,870:132400,871:23888,872:9908,873:141778,874:24134,875:58541,876:135300,877:136969,878:55982,879:32934,880:55427,881:138982,882:28548,883:136480,884:132196,885:5650,886:21859,887:37970,888:58543,889:11426,890:140072,891:45899,892:58461,893:23655,894:137561,895:24203,896:6128,897:7922,898:17539,899:137690,900:9931,901:45410,902:24492,903:139043,904:45458,905:24086,906:7122,907:134497,908:139879,909:17781,910:9541,911:23966,912:4748,913:17976,914:137697,915:18046,916:132839,917:9803,918:20115,919:4847,920:28469,921:9260,922:9801,923:142295,924:133741,925:135887,926:138172,927:17621,928:138368,929:9924,930:142559,931:45650,932:17799,933:137702,934:4134,935:132199,936:38496,937:139203,938:9674,939:4750,940:17552,941:10796,942:855,943:59057,944:135405,945:136191,946:4618,947:9009,948:58893,949:133606,950:132480,951:4817,952:134761,953:45814,954:138423,955:136194,956:22773,957:5769,958:136190,959:9874,960:136538,961:131111,962:136384,963:9381,964:4609,965:1221,966:24432,967:134417,968:55714,969:58689,970:38247,971:9394,972:24378,973:131178,974:17670,975:55915,976:134418,977:136515,978:141711,979:59257,980:133774,981:3462,982:9395,983:131429,984:7029,985:140900,986:63691,987:137047,988:136030,989:23724,990:133948,991:140607,992:4809,993:5645}
try:
    val = []
    for id, asn in asn_info.items():
        sql = "insert into fping_asn(operator_id, asn) VALUES (%s, %s);"
    cursor.executemany(sql, val)
    db.commit()
except:
    db.rollback()
    traceback.print_exc()
else:
    db.commit()
finally:
    cursor.close()

print(asn_dict)
