[(datetime.datetime(2023, 10, 8, 23, 40), 11629135336015.0, 10211591801701.0), 
(datetime.datetime(2023, 10, 8, 23, 45), 11629135336127.0, 10211591819553.0), 
(datetime.datetime(2023, 10, 8, 23, 50), 11629135336295.0, 10211591837413.0), 
(datetime.datetime(2023, 10, 8, 23, 55), 11629135336407.0, 10211591855681.0), 
(datetime.datetime(2023, 10, 9, 0, 0), 11629135336575.0, 10211591873645.0), 
(datetime.datetime(2023, 10, 9, 0, 5), 11629135336687.0, 10211591891601.0), 
(datetime.datetime(2023, 10, 9, 0, 10), 11629135336855.0, 10211591909565.0), 
(datetime.datetime(2023, 10, 9, 0, 15), 11629881000765.0, 10211629487732.0),    
(datetime.datetime(2023, 10, 9, 0, 20), 11632121908486.0, 10211722742488.0),    56.99, 2.37
(datetime.datetime(2023, 10, 9, 0, 25), 11634286099151.0, 10211832410598.0),    55.04, 2.79
(datetime.datetime(2023, 10, 9, 0, 30), 11636551262186.0, 10212025881049.0),    57.60, 4.92
(datetime.datetime(2023, 10, 9, 0, 35), 11641067384907.0, 10213942667938.0), 
(datetime.datetime(2023, 10, 9, 0, 40), 11646170069786.0, 10216170163663.0)]



from clickhouse_driver import Client
from datetime import datetime, timedelta

CK_HOST = "10.13.133.135"
CK_USER = "flowdata"
CK_PASSWORD = "wVen6RK3KpkpGdsA"
CK_DB_ANME = "flow_snmp"
CK_PORT = 9000
client = Client(host=CK_HOST, port=CK_PORT, user=CK_USER, password=CK_PASSWORD)
FLOW_TABLE_NAME = 'flow_data_local_new'

meitu_pipe_id = '20929d02-5a1d-11ee-bb54-4e35d34f6fb5'


def update_flow(test_flow_list):
    print(test_flow_list)
    for flow_data in test_flow_list:
        flow_time, in_bps, out_bps = flow_data
        sql = "ALTER TABLE flow_snmp.flow_data_local_new UPDATE in_bps = {},out_bps = {} WHERE pipe_id = '{}' " \
              "and time = '{}';".format(in_bps, out_bps, meitu_pipe_id, flow_time)
        client.execute(sql)

test_flow_list = [
    (datetime(2023, 10, 9, 0, 20), 2240907721, 93254756),
    (datetime(2023, 10, 9, 0, 25), 2164190665, 109668110),
    (datetime(2023, 10, 9, 0, 30), 2265163035, 193470451),
]

update_flow(test_flow_list)