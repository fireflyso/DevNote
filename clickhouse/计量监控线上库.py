from clickhouse_driver import Client

CK_HOST = "10.13.133.133"
CK_USER = "flowdata"
CK_PASSWORD = "wVen6RK3KpkpGdsA"
CK_DB_ANME = "flow_snmp"
CK_PORT = 9000
client = Client(host=CK_HOST, port=CK_PORT, user=CK_USER, password=CK_PASSWORD)

client.execute("select time, in_bps, out_bps from flow_snmp.flow_data WHERE pipe_id = 'e74fa4e0-3d8a-11ed-9be2-7a4d1b50eb70' and time >= '2023-12-01 00:00:00' and time < '2024-01-01 00:00:00' order by time")
client.execute("select distinct pipe_id from flow_snmp.flow_data WHERE time >= '2024-12-01 00:00:00'")


client.execute("ALTER TABLE flow_snmp.flow_data_local_new UPDATE in_bps = 908261203.0,out_bps = 580537717.0 WHERE pipe_id = '20929d02-5a1d-11ee-bb54-4e35d34f6fb5' and time = '2023-10-18 20:10:00';")
client.execute("ALTER TABLE flow_snmp.flow_data_local_new UPDATE in_bps = 1066420787.0,out_bps = 627955112.0 WHERE pipe_id = '20929d02-5a1d-11ee-bb54-4e35d34f6fb5' and time = '2023-10-18 15:05:00';")


client.execute("select time, in_flow, out_flow, in_bps, out_bps from flow_snmp.flow_data WHERE pipe_id = '18f51046-ce07-11ec-8970-5e235cb0aaf1' and time > '2024-01-02 00:50:00' order by time desc limit 10")
client.execute("select * from flow_snmp.flow_data WHERE pipe_id = '1b6f921e-6bff-11ee-b520-927782286ba1' and time >= '2023-11-30 20:50:00' and time < '2023-11-30 21:10:00' order by time desc")


client.execute("select time, in_bps, out_bps from flow_snmp.flow_data WHERE pipe_id = '20929d02-5a1d-11ee-bb54-4e35d34f6fb5' and time = '2023-10-18 20:10:00'")
client.execute("select time, in_bps, out_bps from flow_snmp.flow_data WHERE pipe_id = '20929d02-5a1d-11ee-bb54-4e35d34f6fb5' and time = '2023-10-18 15:05:00'")
client.execute("select time, in_bps, out_bps from flow_snmp.flow_data_second_all WHERE pipe_id = 'dded4146-68fe-11ee-ad98-26c88fb1f070' and time >= '2023-10-17 15:00:00'")

client.execute("ALTER TABLE flow_snmp.flow_data_local_new DELETE WHERE pipe_id = '1b6f921e-6bff-11ee-b520-927782286ba1' and time = '2023-11-30 20:55:00';")
client.execute("ALTER TABLE flow_snmp.flow_data_local_new DELETE WHERE pipe_id = '1b6f921e-6bff-11ee-b520-927782286ba1' and time = '2023-11-30 21:00:00';")

client.execute("INSERT INTO flow_snmp.flow_data_local_new (pipe_id, `time`, in_flow, out_flow, in_bps, out_bps) VALUES('1b6f921e-6bff-11ee-b520-927782286ba1', '2023-11-30 20:55:00', 0.0, 0.0, 1368651284.0, 57020847453.0)")
client.execute("INSERT INTO flow_snmp.flow_data_local_new (pipe_id, `time`, in_flow, out_flow, in_bps, out_bps) VALUES('1b6f921e-6bff-11ee-b520-927782286ba1', '2023-11-30 21:00:00', 0.0, 0.0, 1368651284.0, 57020847453.0)")


res_list = client.execute("select time, sum(in_bps), sum(out_bps) from flow_snmp.flow_data WHERE pipe_id in ('01969028-43d6-11ee-a0d1-c2d95376be84', '025ee390-4c5d-11ee-b005-4acd0fbc45a5', '02fb4ff6-2560-11ee-b092-8edc80ca2126', '0500457a-4ae7-11ee-b005-4acd0fbc45a5', '09ba44b0-369e-11ee-abeb-fe156b49c309', '1082414e-6fc0-11ed-b540-aa0df6de24f1', '115dc2b6-dd00-11ed-b120-7eb3022aafd7', '115dc414-dd00-11ed-b120-7eb3022aafd7', '132c32f4-4bd6-11ee-8e52-163f196f2d01', '132c3466-4bd6-11ee-8e52-163f196f2d01', '17888d48-5108-11ee-ab57-2a67ec848099', '17b01d88-4d55-11ee-b005-4acd0fbc45a5', '19e43620-db41-11ec-9e88-d69df78e0c59', '1f318dca-5eb3-11ee-94e1-660920dc2c55', '20929d02-5a1d-11ee-bb54-4e35d34f6fb5', '20c03eea-84f0-11ed-9a10-92dd28c1288e', '224285dc-5b75-11ee-bb54-4e35d34f6fb5', '266be002-32b9-11ee-a212-8edc80ca2126', '2710e9e6-6593-11ee-ad98-26c88fb1f070', '2832d4d8-0cb1-11ed-96bf-d26dd8cd860a', '29fc00c4-4d32-11ee-b005-4acd0fbc45a5', '2a03743e-29ed-11ee-b573-fe156b49c309', '2bf5784a-28ae-11ee-a212-8edc80ca2126', '2bf579a8-28ae-11ee-a212-8edc80ca2126', '2bf57a34-28ae-11ee-a212-8edc80ca2126', '2bf57a98-28ae-11ee-a212-8edc80ca2126', '2bf57afc-28ae-11ee-a212-8edc80ca2126', '2c26a678-b32d-11ed-9ab7-32aad41357e5', '2d848e5e-1593-11ee-ad08-3ed88ba9e499', '2f56a134-09ba-11ee-a462-1e4274f3791e', '2fcba7a6-1656-11ee-bf18-d2f3ccab9f25', '30328394-64b3-11ee-94e1-660920dc2c55', '34345024-faa7-11ed-b0eb-121ce766340c', '362197ea-fb77-11ed-8f65-e6f28386e77e', '36d13ba4-6388-11ee-ad98-26c88fb1f070', '36d13db6-6388-11ee-ad98-26c88fb1f070', '36d13e7e-6388-11ee-ad98-26c88fb1f070', '36d13eec-6388-11ee-ad98-26c88fb1f070', '36d13f5a-6388-11ee-ad98-26c88fb1f070', '36d13fbe-6388-11ee-ad98-26c88fb1f070', '36d14022-6388-11ee-ad98-26c88fb1f070', '36d14090-6388-11ee-ad98-26c88fb1f070', '36d140f4-6388-11ee-ad98-26c88fb1f070', '36d14158-6388-11ee-ad98-26c88fb1f070', '36d141bc-6388-11ee-ad98-26c88fb1f070', '36d14220-6388-11ee-ad98-26c88fb1f070', '36d14284-6388-11ee-ad98-26c88fb1f070', '36d142de-6388-11ee-ad98-26c88fb1f070', '36d14388-6388-11ee-ad98-26c88fb1f070', '36d143ec-6388-11ee-ad98-26c88fb1f070', '36d14450-6388-11ee-ad98-26c88fb1f070', '36d144b4-6388-11ee-ad98-26c88fb1f070', '36d14518-6388-11ee-ad98-26c88fb1f070', '36d1457c-6388-11ee-ad98-26c88fb1f070', '36d145e0-6388-11ee-ad98-26c88fb1f070', '36d1463a-6388-11ee-ad98-26c88fb1f070', '3710daa4-84e3-11ed-9297-92dd28c1288e', '3847c440-2c69-11ee-b092-8edc80ca2126', '38749262-09ba-11ee-a462-1e4274f3791e', '394a57b8-b97d-11ed-8933-5e63772294c4', '3a50623c-2ee5-11ee-abeb-fe156b49c309', '3a8ab026-6681-11ee-94e1-660920dc2c55', '3b8c7502-1ae8-11ee-914e-3e551551cbb4', '3bf80c30-5c34-11ee-bb54-4e35d34f6fb5', '3bf80dac-5c34-11ee-bb54-4e35d34f6fb5', '3db2cda2-2dbe-11ee-abeb-fe156b49c309', '3db2cf00-2dbe-11ee-abeb-fe156b49c309', '3e094d94-3fcf-11ee-92fc-c2d95376be84', '3e9f7082-e4e2-11ed-bdbb-a64f25f331a7', '403e3b00-2f64-11ed-8215-beedb2ed67bd', '43998266-cfe9-11ed-b079-26f0da29228a', '439983c4-cfe9-11ed-b079-26f0da29228a', '4399843c-cfe9-11ed-b079-26f0da29228a', '439984aa-cfe9-11ed-b079-26f0da29228a', '43998518-cfe9-11ed-b079-26f0da29228a', '4399857c-cfe9-11ed-b079-26f0da29228a', '439985e0-cfe9-11ed-b079-26f0da29228a', '43998644-cfe9-11ed-b079-26f0da29228a', '439986a8-cfe9-11ed-b079-26f0da29228a', '4399870c-cfe9-11ed-b079-26f0da29228a', '43b6a4ae-4325-11ee-96fc-3ec652d9135b', '441a8f40-e4a8-11ed-b8a4-2a61f32982b3', '45504b3e-2da0-11ee-a212-8edc80ca2126', '45f03b8e-5ba0-11ee-bb54-4e35d34f6fb5', '4606e0a6-5a96-11ee-bb54-4e35d34f6fb5', '46be3836-d2d4-11ed-a94d-cea1660bacf7', '481b2ed4-42fd-11ee-a0d1-c2d95376be84', '48fda712-4264-11ee-9dd0-c2e5e223b0cb', '48ff3586-2546-11ee-b092-8edc80ca2126', '4a608816-5bb1-11ee-bb54-4e35d34f6fb5', '4a6d2240-b1d1-11ed-b2ad-7ac1c4d8e1d5', '4b1ffe7c-1592-11ee-95c3-3ed88ba9e499', '4b69520a-4d48-11ee-8e52-163f196f2d01', '4bc7bdd4-2f64-11ed-ba3a-aa0c93599854', '4d0d0024-2f1d-11ed-ba3a-aa0c93599854', '4db1ed56-c6ca-11ed-80c5-8aafd25d3da3', '4eb6e0e6-5089-11ee-ada8-7ef2e53a0a4c', '50fbced6-4c8b-11ee-b005-4acd0fbc45a5', '50fbd03e-4c8b-11ee-b005-4acd0fbc45a5', '51c1e74c-5de3-11ee-ad98-26c88fb1f070', '547d004e-957e-11ed-900e-5a14de87754d', '55cf8460-64dd-11ee-ad98-26c88fb1f070', '55dec9cc-6369-11ee-94e1-660920dc2c55', '5713f0d6-2f64-11ed-af39-beedb2ed67bd', '57689fe0-ebfd-11ed-b9c2-228bd07ca645', '5b5893e6-6676-11ee-94e1-660920dc2c55', '5b5e648e-4d43-11ee-b005-4acd0fbc45a5', '5bab52a0-4c8d-11ee-b005-4acd0fbc45a5', '5f9d72b8-fe08-11ed-b8e4-a603d07d41fa', '627f37ca-2dbd-11ee-9146-fe156b49c309', '627f3914-2dbd-11ee-9146-fe156b49c309', '63dfaa06-1ed0-11ee-845e-525e818ae952', '650c3728-dcc7-11ed-b120-7eb3022aafd7', '653cbb2a-64dd-11ee-ad98-26c88fb1f070', '656da9e0-6755-11ee-94e1-660920dc2c55', '656dab3e-6755-11ee-94e1-660920dc2c55', '656dabc0-6755-11ee-94e1-660920dc2c55', '65f6bb06-666d-11ee-ad98-26c88fb1f070', '669cf0ce-46d9-11ee-8cd2-5a68c63594a6', '68b59ef8-65b8-11ee-94e1-660920dc2c55', '68b5a060-65b8-11ee-94e1-660920dc2c55', '69027832-2f7a-11ee-9146-fe156b49c309', '69d14578-6746-11ee-94e1-660920dc2c55', '6aefb95a-5c4a-11ee-bb54-4e35d34f6fb5', '6aefbaae-5c4a-11ee-bb54-4e35d34f6fb5', '6aefbb3a-5c4a-11ee-bb54-4e35d34f6fb5', '6b97ed5a-2f64-11ed-8215-beedb2ed67bd', '6cadb0ea-3b47-11ee-9c78-6619d75d9e65', '6cadb27a-3b47-11ee-9c78-6619d75d9e65', '6cadb306-3b47-11ee-9c78-6619d75d9e65', '6d8993f4-cfe9-11ed-b079-26f0da29228a', '6d899548-cfe9-11ed-b079-26f0da29228a', '6f7d1cc2-c3cc-11ed-930b-d2fa31d9ddca', '6fb77ce8-4872-11ee-8e52-163f196f2d01', '70d62d6c-55fc-11ee-8573-ca21895e3d63', '7117739c-f0a5-11ed-b7da-e62f4848ef55', '7138017e-faa6-11ed-809b-a603d07d41fa', '71dd79f0-6442-11ee-ad98-26c88fb1f070', '7252ff40-4e53-11ee-b005-4acd0fbc45a5', '74e2fb7a-1645-11ee-bf18-d2f3ccab9f25', '753470b0-55f9-11ee-ab57-2a67ec848099', '7547f656-5c3b-11ee-bb54-4e35d34f6fb5', '7547f822-5c3b-11ee-bb54-4e35d34f6fb5', '7547f8cc-5c3b-11ee-bb54-4e35d34f6fb5', '7552f1ea-08c7-11ee-87dc-b2063df62928', '755595e0-5b50-11ee-bb54-4e35d34f6fb5', '7619f782-5696-11ee-ada8-7ef2e53a0a4c', '768b60cc-5ce3-11ee-94e1-660920dc2c55', '768b613a-5ce3-11ee-94e1-660920dc2c55', '78a4f0e6-4c51-11ee-b005-4acd0fbc45a5', '7968a674-40e1-11ee-bbcc-3ec652d9135b', '7968a7dc-40e1-11ee-bbcc-3ec652d9135b', '7968a868-40e1-11ee-bbcc-3ec652d9135b', '7968a8d6-40e1-11ee-bbcc-3ec652d9135b', '7968a944-40e1-11ee-bbcc-3ec652d9135b', '7af0dbce-591e-11ee-8f76-92fb8eaf2ec9', '7ba12b6a-6652-11ed-9101-f2ed21996a26', '7cfe3250-561b-11ee-ab57-2a67ec848099', '7da5e410-d9ba-11ed-bff3-cea1660bacf7', '7ef5ee34-5b9f-11ee-bb54-4e35d34f6fb5', '7f89689a-dd04-11ed-bff3-cea1660bacf7', '824ebe6c-5c49-11ee-bb54-4e35d34f6fb5', '824ebfd4-5c49-11ee-bb54-4e35d34f6fb5', '8281114a-a052-11ed-9b32-c253b0b4ce62', '83c36e8e-ed9d-11ed-84eb-228bd07ca645', '84df7fc8-64bd-11ee-94e1-660920dc2c55', '84df8130-64bd-11ee-94e1-660920dc2c55', '84df81a8-64bd-11ee-94e1-660920dc2c55', '84df820c-64bd-11ee-94e1-660920dc2c55', '84ecb850-5054-11ee-a383-96761a61c7eb', '8501dd90-5264-11ee-ab57-2a67ec848099', '853d1c1a-e4e2-11ed-b9c2-228bd07ca645', '853d1e36-e4e2-11ed-b9c2-228bd07ca645', '86d93c52-5c3d-11ee-bb54-4e35d34f6fb5', '8742c0d6-fb72-11ed-8f65-e6f28386e77e', '877aa28e-2b7a-11ee-a7b3-fe156b49c309', '87eac2dc-64d1-11ed-845c-aa0df6de24f1', '8836f170-5067-11ee-b005-4acd0fbc45a5', '8908febe-6740-11ee-94e1-660920dc2c55', '8935d0d8-5d09-11ee-ad98-26c88fb1f070', '8bae1e30-442a-11ee-a0d1-c2d95376be84', '8bc5f68a-579f-11ee-a942-ba11c4fa0c1d', '8cdcd7ac-ffa0-11ed-bd44-a603d07d41fa', '8cdcd90a-ffa0-11ed-bd44-a603d07d41fa', '8cdcd996-ffa0-11ed-bd44-a603d07d41fa', '8d89d484-4573-11ee-b174-36f2e5b62678', '8e31db7e-fad3-11ed-b8e4-a603d07d41fa', '907079a2-4ebd-11ee-b005-4acd0fbc45a5', '90b98222-6386-11ee-ad98-26c88fb1f070', '97b4fa04-504c-11ee-8e52-163f196f2d01', '97b4fb76-504c-11ee-8e52-163f196f2d01', '97b4fbf8-504c-11ee-8e52-163f196f2d01', '995d8a62-5842-11ee-8f76-92fb8eaf2ec9', '995d8bde-5842-11ee-8f76-92fb8eaf2ec9', '995da0ca-5d3c-11ee-ad98-26c88fb1f070', '99ea470a-1f20-11ee-bbae-fe156b49c309', '9ab75d60-84ef-11ed-b85a-b295042e0991', '9b51f00a-858f-11ed-8139-92dd28c1288e', '9b824578-64ee-11ed-845c-aa0df6de24f1', '9c5f02e4-5a1e-11ee-bb54-4e35d34f6fb5', '9e29c4ae-46de-11ee-8cd2-5a68c63594a6', '9eea3ec0-fad8-11ed-b8e4-a603d07d41fa', '9f2db8ba-3b30-11ee-9056-f6ef532488df', '9f554914-432a-11ee-92fc-c2d95376be84', 'a035125e-fb8d-11ed-8f65-e6f28386e77e', 'a088ba20-fabc-11ed-b8e4-a603d07d41fa', 'a19ed3ee-0454-11ee-aa83-fe0e6a9c67eb', 'a19ed5ba-0454-11ee-aa83-fe0e6a9c67eb', 'a205e746-3c03-11ee-9056-f6ef532488df', 'a568283e-3c1e-11ee-8103-6619d75d9e65', 'a5a2029e-f951-11ed-aea4-4681e009663a', 'a781bdfe-507a-11ee-b005-4acd0fbc45a5', 'a9e872d0-d9ac-11ed-bff3-cea1660bacf7', 'a9e874c4-d9ac-11ed-bff3-cea1660bacf7', 'a9e87546-d9ac-11ed-bff3-cea1660bacf7', 'ab3e2df8-be56-11ed-8948-7ee273f713be', 'ab8ee54e-6654-11ee-ad98-26c88fb1f070', 'abb95d96-0a6b-11ee-b29a-fa63c7983957', 'ad9c90ca-874d-11ed-a748-66a7724c12ab', 'ad9c916a-874d-11ed-a748-66a7724c12ab', 'ad9c91f6-874d-11ed-a748-66a7724c12ab', 'ad9c928c-874d-11ed-a748-66a7724c12ab', 'ad9c93fe-874d-11ed-a748-66a7724c12ab', 'ad9c9458-874d-11ed-a748-66a7724c12ab', 'ad9c94b2-874d-11ed-a748-66a7724c12ab', 'afbea470-b0eb-11ed-8218-122a3593d4a9', 'afda76a2-2551-11ee-b092-8edc80ca2126', 'afda78dc-2551-11ee-b092-8edc80ca2126', 'afda795e-2551-11ee-b092-8edc80ca2126', 'afda79cc-2551-11ee-b092-8edc80ca2126', 'afda7a3a-2551-11ee-b092-8edc80ca2126', 'afda7a9e-2551-11ee-b092-8edc80ca2126', 'b018ecbe-41a5-11ee-bbcc-3ec652d9135b', 'b2107c62-668a-11ee-ad98-26c88fb1f070', 'b2c7bc56-ac18-11ed-847a-624be771b801', 'b3952cf0-e312-11ed-b6f6-2a61f32982b3', 'b4a0192c-9090-11ed-9c6b-2604804d0752', 'b5313676-55fe-11ee-ada8-7ef2e53a0a4c', 'b61d6544-ac37-11ed-b3d5-329913ddb37c', 'b71bf0c0-122a-11ed-ab94-a283cee99fa9', 'ba3e53e4-5ce1-11ee-94e1-660920dc2c55', 'ba70f672-4257-11ee-bbcc-3ec652d9135b', 'bbc69788-e4a7-11ed-bc9a-3aa141d911e2', 'bc57a9e4-865b-11ed-b27a-92dd28c1288e', 'bd3f4fbc-1592-11ee-ad08-3ed88ba9e499', 'bd85ad3a-9096-11ed-9be1-66a7724c12ab', 'bd85af06-9096-11ed-9be1-66a7724c12ab', 'be485df2-4aeb-11ee-b005-4acd0fbc45a5', 'bf42f156-8fdc-11ed-ab35-66a7724c12ab', 'bfce40c2-5dda-11ee-94e1-660920dc2c55', 'c0b63d28-579a-11ee-a942-ba11c4fa0c1d', 'c0b63e86-579a-11ee-a942-ba11c4fa0c1d', 'c0ec0f68-df2a-11ed-bff3-cea1660bacf7', 'c172da80-cfe8-11ed-b079-26f0da29228a', 'c172dbe8-cfe8-11ed-b079-26f0da29228a', 'c172dc6a-cfe8-11ed-b079-26f0da29228a', 'c172dcd8-cfe8-11ed-b079-26f0da29228a', 'c172dd3c-cfe8-11ed-b079-26f0da29228a', 'c172dda0-cfe8-11ed-b079-26f0da29228a', 'c172de0e-cfe8-11ed-b079-26f0da29228a', 'c172de72-cfe8-11ed-b079-26f0da29228a', 'c172ded6-cfe8-11ed-b079-26f0da29228a', 'c172df3a-cfe8-11ed-b079-26f0da29228a', 'c44202be-57a0-11ee-a942-ba11c4fa0c1d', 'c5a48ecc-4aff-11ee-abec-2efbca2353fb', 'c76dde0c-5e65-11ed-98f7-cacc6eb3f2fc', 'c76ddf74-5e65-11ed-98f7-cacc6eb3f2fc', 'c8c1eff6-56d9-11ee-99c8-d6ae37b9a49b', 'c8c5f172-fb90-11ed-b8e4-a603d07d41fa', 'c9ba4b64-55fe-11ee-ada8-7ef2e53a0a4c', 'c9e78352-4197-11ee-981a-0e2b58a24e3f', 'cacbfa2a-5b67-11ee-bb54-4e35d34f6fb5', 'cae37ec0-41b8-11ee-a0d1-c2d95376be84', 'cbaccc8c-8fdc-11ed-9c6b-2604804d0752', 'cc3cf456-80dc-11ed-9f6e-92dd28c1288e', 'cc83c392-87ec-11ed-8e19-2604804d0752', 'ccba0eae-84f7-11ed-b85a-b295042e0991', 'cd0d0942-3d75-11ee-bbcc-3ec652d9135b', 'cd0d0ae6-3d75-11ee-bbcc-3ec652d9135b', 'cd0d0b68-3d75-11ee-bbcc-3ec652d9135b', 'cd0d0bd6-3d75-11ee-bbcc-3ec652d9135b', 'cd0d0c44-3d75-11ee-bbcc-3ec652d9135b', 'd02e1ef8-3c13-11ee-ada2-f6ef532488df', 'd0d7a944-4d68-11ee-8e52-163f196f2d01', 'd0ffba3e-3f43-11ee-bbcc-3ec652d9135b', 'd170b820-d8e0-11ed-8a5e-7eb3022aafd7', 'd170b992-d8e0-11ed-8a5e-7eb3022aafd7', 'd170ba0a-d8e0-11ed-8a5e-7eb3022aafd7', 'd170ba78-d8e0-11ed-8a5e-7eb3022aafd7', 'd170badc-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bb40-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bba4-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bc08-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bc6c-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bcc6-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bd2a-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bd8e-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bde8-d8e0-11ed-8a5e-7eb3022aafd7', 'd170be4c-d8e0-11ed-8a5e-7eb3022aafd7', 'd170beb0-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bf0a-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bf6e-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bfd2-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c036-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c090-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c0f4-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c14e-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c1b2-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c20c-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c270-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c2d4-d8e0-11ed-8a5e-7eb3022aafd7', 'd385234e-358d-11ee-abeb-fe156b49c309', 'd3c6ecb4-67da-11ee-94e1-660920dc2c55', 'd54b035a-bd75-11ed-8570-f2f629e3b6b5', 'd5bda440-41ec-11ee-a0d1-c2d95376be84', 'd5bda5bc-41ec-11ee-a0d1-c2d95376be84', 'd5bda648-41ec-11ee-a0d1-c2d95376be84', 'd5bda6b6-41ec-11ee-a0d1-c2d95376be84', 'd5bda72e-41ec-11ee-a0d1-c2d95376be84', 'd5f96474-f950-11ed-afb8-e62f4848ef55', 'd705b018-4642-11ee-b962-e6127bb19385', 'd70f9602-e25a-11ec-a419-ca9a0ab92160', 'd728fde6-0a76-11ee-b990-fa63c7983957', 'd7ea49b6-ebfd-11ed-bdbb-a64f25f331a7', 'd84d25e2-5c49-11ee-a983-3a6a4fd51549', 'dabb1f76-56dd-11ee-a730-123a7cd7feb8', 'db5311ac-5794-11ee-a942-ba11c4fa0c1d', 'dc5a7ffc-29a7-11ed-ba3a-aa0c93599854', 'dd005440-64b6-11ee-94e1-660920dc2c55', 'e0795b1e-5c17-11ee-a983-3a6a4fd51549', 'e38129f0-8502-11ed-baf8-b295042e0991', 'e3affd56-c6ad-11ed-80c5-8aafd25d3da3', 'e46422b0-1b0b-11ee-a3eb-3e551551cbb4', 'e48115c6-1a40-11ee-b009-22af8d3ca085', 'e4ecaca4-025a-11ed-a29c-02a8f1fdcf0c', 'e7e94628-5b74-11ee-a983-3a6a4fd51549', 'e8aa41f8-f615-11ed-895e-4681e009663a', 'e937dc8e-83a6-11ed-bba1-92dd28c1288e', 'e937de14-83a6-11ed-bba1-92dd28c1288e', 'e937dea0-83a6-11ed-bba1-92dd28c1288e', 'ea88aea6-25a4-11ee-b092-8edc80ca2126', 'ea88b04a-25a4-11ee-b092-8edc80ca2126', 'ea88b0d6-25a4-11ee-b092-8edc80ca2126', 'ea88b13a-25a4-11ee-b092-8edc80ca2126', 'ea88b19e-25a4-11ee-b092-8edc80ca2126', 'ea88b202-25a4-11ee-b092-8edc80ca2126', 'ea88b266-25a4-11ee-b092-8edc80ca2126', 'ea8a1e26-8662-11ed-9640-66a7724c12ab', 'eab58586-8200-11ed-8a82-92dd28c1288e', 'eb945a10-5093-11ee-ada8-7ef2e53a0a4c', 'eba4e2ba-fb91-11ed-a30a-4abfda84734e', 'edd0d5ae-478f-11ee-a925-de638601213f', 'edd0d770-478f-11ee-a925-de638601213f', 'ee143948-6670-11ee-94e1-660920dc2c55', 'eebfcf84-1593-11ee-95c3-3ed88ba9e499', 'f23486d6-8caa-11ed-9c6b-2604804d0752', 'f28c8336-32b8-11ee-a212-8edc80ca2126', 'f31b776c-1ca6-11ee-845e-525e818ae952', 'f413814c-6381-11ee-ad98-26c88fb1f070', 'f4a93a76-56b6-11ed-b881-4eeadc686147', 'f4e22aec-fadb-11ed-b0eb-121ce766340c', 'f74192c6-4e4d-11ee-8905-127c1229a346', 'f7419456-4e4d-11ee-8905-127c1229a346', 'f741953c-4e4d-11ee-8905-127c1229a346', 'f8fff63e-2c2e-11ee-ae13-8edc80ca2126', 'fa92112e-5fac-11ee-ad98-26c88fb1f070', 'fb42e6d4-5903-11ee-a942-ba11c4fa0c1d', 'fb42e828-5903-11ee-a942-ba11c4fa0c1d', 'fc179eee-dcf6-11ed-bff3-cea1660bacf7', 'fc3d6354-cc66-11ed-9f1d-8aafd25d3da3', 'fe2b530c-d8db-11ed-8a5e-7eb3022aafd7', 'fe395122-575d-11ee-a942-ba11c4fa0c1d', 'feb076f8-5b9f-11ee-a983-3a6a4fd51549') and time >= '2023-10-11 10:00:00' and time <= '2023-10-11 11:00:00' group by time order by time")
res_list_back = client.execute("select time, sum(in_bps), sum(out_bps) from flow_snmp.flow_data_second_all WHERE pipe_id in ('01969028-43d6-11ee-a0d1-c2d95376be84', '025ee390-4c5d-11ee-b005-4acd0fbc45a5', '02fb4ff6-2560-11ee-b092-8edc80ca2126', '0500457a-4ae7-11ee-b005-4acd0fbc45a5', '09ba44b0-369e-11ee-abeb-fe156b49c309', '1082414e-6fc0-11ed-b540-aa0df6de24f1', '115dc2b6-dd00-11ed-b120-7eb3022aafd7', '115dc414-dd00-11ed-b120-7eb3022aafd7', '132c32f4-4bd6-11ee-8e52-163f196f2d01', '132c3466-4bd6-11ee-8e52-163f196f2d01', '17888d48-5108-11ee-ab57-2a67ec848099', '17b01d88-4d55-11ee-b005-4acd0fbc45a5', '19e43620-db41-11ec-9e88-d69df78e0c59', '1f318dca-5eb3-11ee-94e1-660920dc2c55', '20929d02-5a1d-11ee-bb54-4e35d34f6fb5', '20c03eea-84f0-11ed-9a10-92dd28c1288e', '224285dc-5b75-11ee-bb54-4e35d34f6fb5', '266be002-32b9-11ee-a212-8edc80ca2126', '2710e9e6-6593-11ee-ad98-26c88fb1f070', '2832d4d8-0cb1-11ed-96bf-d26dd8cd860a', '29fc00c4-4d32-11ee-b005-4acd0fbc45a5', '2a03743e-29ed-11ee-b573-fe156b49c309', '2bf5784a-28ae-11ee-a212-8edc80ca2126', '2bf579a8-28ae-11ee-a212-8edc80ca2126', '2bf57a34-28ae-11ee-a212-8edc80ca2126', '2bf57a98-28ae-11ee-a212-8edc80ca2126', '2bf57afc-28ae-11ee-a212-8edc80ca2126', '2c26a678-b32d-11ed-9ab7-32aad41357e5', '2d848e5e-1593-11ee-ad08-3ed88ba9e499', '2f56a134-09ba-11ee-a462-1e4274f3791e', '2fcba7a6-1656-11ee-bf18-d2f3ccab9f25', '30328394-64b3-11ee-94e1-660920dc2c55', '34345024-faa7-11ed-b0eb-121ce766340c', '362197ea-fb77-11ed-8f65-e6f28386e77e', '36d13ba4-6388-11ee-ad98-26c88fb1f070', '36d13db6-6388-11ee-ad98-26c88fb1f070', '36d13e7e-6388-11ee-ad98-26c88fb1f070', '36d13eec-6388-11ee-ad98-26c88fb1f070', '36d13f5a-6388-11ee-ad98-26c88fb1f070', '36d13fbe-6388-11ee-ad98-26c88fb1f070', '36d14022-6388-11ee-ad98-26c88fb1f070', '36d14090-6388-11ee-ad98-26c88fb1f070', '36d140f4-6388-11ee-ad98-26c88fb1f070', '36d14158-6388-11ee-ad98-26c88fb1f070', '36d141bc-6388-11ee-ad98-26c88fb1f070', '36d14220-6388-11ee-ad98-26c88fb1f070', '36d14284-6388-11ee-ad98-26c88fb1f070', '36d142de-6388-11ee-ad98-26c88fb1f070', '36d14388-6388-11ee-ad98-26c88fb1f070', '36d143ec-6388-11ee-ad98-26c88fb1f070', '36d14450-6388-11ee-ad98-26c88fb1f070', '36d144b4-6388-11ee-ad98-26c88fb1f070', '36d14518-6388-11ee-ad98-26c88fb1f070', '36d1457c-6388-11ee-ad98-26c88fb1f070', '36d145e0-6388-11ee-ad98-26c88fb1f070', '36d1463a-6388-11ee-ad98-26c88fb1f070', '3710daa4-84e3-11ed-9297-92dd28c1288e', '3847c440-2c69-11ee-b092-8edc80ca2126', '38749262-09ba-11ee-a462-1e4274f3791e', '394a57b8-b97d-11ed-8933-5e63772294c4', '3a50623c-2ee5-11ee-abeb-fe156b49c309', '3a8ab026-6681-11ee-94e1-660920dc2c55', '3b8c7502-1ae8-11ee-914e-3e551551cbb4', '3bf80c30-5c34-11ee-bb54-4e35d34f6fb5', '3bf80dac-5c34-11ee-bb54-4e35d34f6fb5', '3db2cda2-2dbe-11ee-abeb-fe156b49c309', '3db2cf00-2dbe-11ee-abeb-fe156b49c309', '3e094d94-3fcf-11ee-92fc-c2d95376be84', '3e9f7082-e4e2-11ed-bdbb-a64f25f331a7', '403e3b00-2f64-11ed-8215-beedb2ed67bd', '43998266-cfe9-11ed-b079-26f0da29228a', '439983c4-cfe9-11ed-b079-26f0da29228a', '4399843c-cfe9-11ed-b079-26f0da29228a', '439984aa-cfe9-11ed-b079-26f0da29228a', '43998518-cfe9-11ed-b079-26f0da29228a', '4399857c-cfe9-11ed-b079-26f0da29228a', '439985e0-cfe9-11ed-b079-26f0da29228a', '43998644-cfe9-11ed-b079-26f0da29228a', '439986a8-cfe9-11ed-b079-26f0da29228a', '4399870c-cfe9-11ed-b079-26f0da29228a', '43b6a4ae-4325-11ee-96fc-3ec652d9135b', '441a8f40-e4a8-11ed-b8a4-2a61f32982b3', '45504b3e-2da0-11ee-a212-8edc80ca2126', '45f03b8e-5ba0-11ee-bb54-4e35d34f6fb5', '4606e0a6-5a96-11ee-bb54-4e35d34f6fb5', '46be3836-d2d4-11ed-a94d-cea1660bacf7', '481b2ed4-42fd-11ee-a0d1-c2d95376be84', '48fda712-4264-11ee-9dd0-c2e5e223b0cb', '48ff3586-2546-11ee-b092-8edc80ca2126', '4a608816-5bb1-11ee-bb54-4e35d34f6fb5', '4a6d2240-b1d1-11ed-b2ad-7ac1c4d8e1d5', '4b1ffe7c-1592-11ee-95c3-3ed88ba9e499', '4b69520a-4d48-11ee-8e52-163f196f2d01', '4bc7bdd4-2f64-11ed-ba3a-aa0c93599854', '4d0d0024-2f1d-11ed-ba3a-aa0c93599854', '4db1ed56-c6ca-11ed-80c5-8aafd25d3da3', '4eb6e0e6-5089-11ee-ada8-7ef2e53a0a4c', '50fbced6-4c8b-11ee-b005-4acd0fbc45a5', '50fbd03e-4c8b-11ee-b005-4acd0fbc45a5', '51c1e74c-5de3-11ee-ad98-26c88fb1f070', '547d004e-957e-11ed-900e-5a14de87754d', '55cf8460-64dd-11ee-ad98-26c88fb1f070', '55dec9cc-6369-11ee-94e1-660920dc2c55', '5713f0d6-2f64-11ed-af39-beedb2ed67bd', '57689fe0-ebfd-11ed-b9c2-228bd07ca645', '5b5893e6-6676-11ee-94e1-660920dc2c55', '5b5e648e-4d43-11ee-b005-4acd0fbc45a5', '5bab52a0-4c8d-11ee-b005-4acd0fbc45a5', '5f9d72b8-fe08-11ed-b8e4-a603d07d41fa', '627f37ca-2dbd-11ee-9146-fe156b49c309', '627f3914-2dbd-11ee-9146-fe156b49c309', '63dfaa06-1ed0-11ee-845e-525e818ae952', '650c3728-dcc7-11ed-b120-7eb3022aafd7', '653cbb2a-64dd-11ee-ad98-26c88fb1f070', '656da9e0-6755-11ee-94e1-660920dc2c55', '656dab3e-6755-11ee-94e1-660920dc2c55', '656dabc0-6755-11ee-94e1-660920dc2c55', '65f6bb06-666d-11ee-ad98-26c88fb1f070', '669cf0ce-46d9-11ee-8cd2-5a68c63594a6', '68b59ef8-65b8-11ee-94e1-660920dc2c55', '68b5a060-65b8-11ee-94e1-660920dc2c55', '69027832-2f7a-11ee-9146-fe156b49c309', '69d14578-6746-11ee-94e1-660920dc2c55', '6aefb95a-5c4a-11ee-bb54-4e35d34f6fb5', '6aefbaae-5c4a-11ee-bb54-4e35d34f6fb5', '6aefbb3a-5c4a-11ee-bb54-4e35d34f6fb5', '6b97ed5a-2f64-11ed-8215-beedb2ed67bd', '6cadb0ea-3b47-11ee-9c78-6619d75d9e65', '6cadb27a-3b47-11ee-9c78-6619d75d9e65', '6cadb306-3b47-11ee-9c78-6619d75d9e65', '6d8993f4-cfe9-11ed-b079-26f0da29228a', '6d899548-cfe9-11ed-b079-26f0da29228a', '6f7d1cc2-c3cc-11ed-930b-d2fa31d9ddca', '6fb77ce8-4872-11ee-8e52-163f196f2d01', '70d62d6c-55fc-11ee-8573-ca21895e3d63', '7117739c-f0a5-11ed-b7da-e62f4848ef55', '7138017e-faa6-11ed-809b-a603d07d41fa', '71dd79f0-6442-11ee-ad98-26c88fb1f070', '7252ff40-4e53-11ee-b005-4acd0fbc45a5', '74e2fb7a-1645-11ee-bf18-d2f3ccab9f25', '753470b0-55f9-11ee-ab57-2a67ec848099', '7547f656-5c3b-11ee-bb54-4e35d34f6fb5', '7547f822-5c3b-11ee-bb54-4e35d34f6fb5', '7547f8cc-5c3b-11ee-bb54-4e35d34f6fb5', '7552f1ea-08c7-11ee-87dc-b2063df62928', '755595e0-5b50-11ee-bb54-4e35d34f6fb5', '7619f782-5696-11ee-ada8-7ef2e53a0a4c', '768b60cc-5ce3-11ee-94e1-660920dc2c55', '768b613a-5ce3-11ee-94e1-660920dc2c55', '78a4f0e6-4c51-11ee-b005-4acd0fbc45a5', '7968a674-40e1-11ee-bbcc-3ec652d9135b', '7968a7dc-40e1-11ee-bbcc-3ec652d9135b', '7968a868-40e1-11ee-bbcc-3ec652d9135b', '7968a8d6-40e1-11ee-bbcc-3ec652d9135b', '7968a944-40e1-11ee-bbcc-3ec652d9135b', '7af0dbce-591e-11ee-8f76-92fb8eaf2ec9', '7ba12b6a-6652-11ed-9101-f2ed21996a26', '7cfe3250-561b-11ee-ab57-2a67ec848099', '7da5e410-d9ba-11ed-bff3-cea1660bacf7', '7ef5ee34-5b9f-11ee-bb54-4e35d34f6fb5', '7f89689a-dd04-11ed-bff3-cea1660bacf7', '824ebe6c-5c49-11ee-bb54-4e35d34f6fb5', '824ebfd4-5c49-11ee-bb54-4e35d34f6fb5', '8281114a-a052-11ed-9b32-c253b0b4ce62', '83c36e8e-ed9d-11ed-84eb-228bd07ca645', '84df7fc8-64bd-11ee-94e1-660920dc2c55', '84df8130-64bd-11ee-94e1-660920dc2c55', '84df81a8-64bd-11ee-94e1-660920dc2c55', '84df820c-64bd-11ee-94e1-660920dc2c55', '84ecb850-5054-11ee-a383-96761a61c7eb', '8501dd90-5264-11ee-ab57-2a67ec848099', '853d1c1a-e4e2-11ed-b9c2-228bd07ca645', '853d1e36-e4e2-11ed-b9c2-228bd07ca645', '86d93c52-5c3d-11ee-bb54-4e35d34f6fb5', '8742c0d6-fb72-11ed-8f65-e6f28386e77e', '877aa28e-2b7a-11ee-a7b3-fe156b49c309', '87eac2dc-64d1-11ed-845c-aa0df6de24f1', '8836f170-5067-11ee-b005-4acd0fbc45a5', '8908febe-6740-11ee-94e1-660920dc2c55', '8935d0d8-5d09-11ee-ad98-26c88fb1f070', '8bae1e30-442a-11ee-a0d1-c2d95376be84', '8bc5f68a-579f-11ee-a942-ba11c4fa0c1d', '8cdcd7ac-ffa0-11ed-bd44-a603d07d41fa', '8cdcd90a-ffa0-11ed-bd44-a603d07d41fa', '8cdcd996-ffa0-11ed-bd44-a603d07d41fa', '8d89d484-4573-11ee-b174-36f2e5b62678', '8e31db7e-fad3-11ed-b8e4-a603d07d41fa', '907079a2-4ebd-11ee-b005-4acd0fbc45a5', '90b98222-6386-11ee-ad98-26c88fb1f070', '97b4fa04-504c-11ee-8e52-163f196f2d01', '97b4fb76-504c-11ee-8e52-163f196f2d01', '97b4fbf8-504c-11ee-8e52-163f196f2d01', '995d8a62-5842-11ee-8f76-92fb8eaf2ec9', '995d8bde-5842-11ee-8f76-92fb8eaf2ec9', '995da0ca-5d3c-11ee-ad98-26c88fb1f070', '99ea470a-1f20-11ee-bbae-fe156b49c309', '9ab75d60-84ef-11ed-b85a-b295042e0991', '9b51f00a-858f-11ed-8139-92dd28c1288e', '9b824578-64ee-11ed-845c-aa0df6de24f1', '9c5f02e4-5a1e-11ee-bb54-4e35d34f6fb5', '9e29c4ae-46de-11ee-8cd2-5a68c63594a6', '9eea3ec0-fad8-11ed-b8e4-a603d07d41fa', '9f2db8ba-3b30-11ee-9056-f6ef532488df', '9f554914-432a-11ee-92fc-c2d95376be84', 'a035125e-fb8d-11ed-8f65-e6f28386e77e', 'a088ba20-fabc-11ed-b8e4-a603d07d41fa', 'a19ed3ee-0454-11ee-aa83-fe0e6a9c67eb', 'a19ed5ba-0454-11ee-aa83-fe0e6a9c67eb', 'a205e746-3c03-11ee-9056-f6ef532488df', 'a568283e-3c1e-11ee-8103-6619d75d9e65', 'a5a2029e-f951-11ed-aea4-4681e009663a', 'a781bdfe-507a-11ee-b005-4acd0fbc45a5', 'a9e872d0-d9ac-11ed-bff3-cea1660bacf7', 'a9e874c4-d9ac-11ed-bff3-cea1660bacf7', 'a9e87546-d9ac-11ed-bff3-cea1660bacf7', 'ab3e2df8-be56-11ed-8948-7ee273f713be', 'ab8ee54e-6654-11ee-ad98-26c88fb1f070', 'abb95d96-0a6b-11ee-b29a-fa63c7983957', 'ad9c90ca-874d-11ed-a748-66a7724c12ab', 'ad9c916a-874d-11ed-a748-66a7724c12ab', 'ad9c91f6-874d-11ed-a748-66a7724c12ab', 'ad9c928c-874d-11ed-a748-66a7724c12ab', 'ad9c93fe-874d-11ed-a748-66a7724c12ab', 'ad9c9458-874d-11ed-a748-66a7724c12ab', 'ad9c94b2-874d-11ed-a748-66a7724c12ab', 'afbea470-b0eb-11ed-8218-122a3593d4a9', 'afda76a2-2551-11ee-b092-8edc80ca2126', 'afda78dc-2551-11ee-b092-8edc80ca2126', 'afda795e-2551-11ee-b092-8edc80ca2126', 'afda79cc-2551-11ee-b092-8edc80ca2126', 'afda7a3a-2551-11ee-b092-8edc80ca2126', 'afda7a9e-2551-11ee-b092-8edc80ca2126', 'b018ecbe-41a5-11ee-bbcc-3ec652d9135b', 'b2107c62-668a-11ee-ad98-26c88fb1f070', 'b2c7bc56-ac18-11ed-847a-624be771b801', 'b3952cf0-e312-11ed-b6f6-2a61f32982b3', 'b4a0192c-9090-11ed-9c6b-2604804d0752', 'b5313676-55fe-11ee-ada8-7ef2e53a0a4c', 'b61d6544-ac37-11ed-b3d5-329913ddb37c', 'b71bf0c0-122a-11ed-ab94-a283cee99fa9', 'ba3e53e4-5ce1-11ee-94e1-660920dc2c55', 'ba70f672-4257-11ee-bbcc-3ec652d9135b', 'bbc69788-e4a7-11ed-bc9a-3aa141d911e2', 'bc57a9e4-865b-11ed-b27a-92dd28c1288e', 'bd3f4fbc-1592-11ee-ad08-3ed88ba9e499', 'bd85ad3a-9096-11ed-9be1-66a7724c12ab', 'bd85af06-9096-11ed-9be1-66a7724c12ab', 'be485df2-4aeb-11ee-b005-4acd0fbc45a5', 'bf42f156-8fdc-11ed-ab35-66a7724c12ab', 'bfce40c2-5dda-11ee-94e1-660920dc2c55', 'c0b63d28-579a-11ee-a942-ba11c4fa0c1d', 'c0b63e86-579a-11ee-a942-ba11c4fa0c1d', 'c0ec0f68-df2a-11ed-bff3-cea1660bacf7', 'c172da80-cfe8-11ed-b079-26f0da29228a', 'c172dbe8-cfe8-11ed-b079-26f0da29228a', 'c172dc6a-cfe8-11ed-b079-26f0da29228a', 'c172dcd8-cfe8-11ed-b079-26f0da29228a', 'c172dd3c-cfe8-11ed-b079-26f0da29228a', 'c172dda0-cfe8-11ed-b079-26f0da29228a', 'c172de0e-cfe8-11ed-b079-26f0da29228a', 'c172de72-cfe8-11ed-b079-26f0da29228a', 'c172ded6-cfe8-11ed-b079-26f0da29228a', 'c172df3a-cfe8-11ed-b079-26f0da29228a', 'c44202be-57a0-11ee-a942-ba11c4fa0c1d', 'c5a48ecc-4aff-11ee-abec-2efbca2353fb', 'c76dde0c-5e65-11ed-98f7-cacc6eb3f2fc', 'c76ddf74-5e65-11ed-98f7-cacc6eb3f2fc', 'c8c1eff6-56d9-11ee-99c8-d6ae37b9a49b', 'c8c5f172-fb90-11ed-b8e4-a603d07d41fa', 'c9ba4b64-55fe-11ee-ada8-7ef2e53a0a4c', 'c9e78352-4197-11ee-981a-0e2b58a24e3f', 'cacbfa2a-5b67-11ee-bb54-4e35d34f6fb5', 'cae37ec0-41b8-11ee-a0d1-c2d95376be84', 'cbaccc8c-8fdc-11ed-9c6b-2604804d0752', 'cc3cf456-80dc-11ed-9f6e-92dd28c1288e', 'cc83c392-87ec-11ed-8e19-2604804d0752', 'ccba0eae-84f7-11ed-b85a-b295042e0991', 'cd0d0942-3d75-11ee-bbcc-3ec652d9135b', 'cd0d0ae6-3d75-11ee-bbcc-3ec652d9135b', 'cd0d0b68-3d75-11ee-bbcc-3ec652d9135b', 'cd0d0bd6-3d75-11ee-bbcc-3ec652d9135b', 'cd0d0c44-3d75-11ee-bbcc-3ec652d9135b', 'd02e1ef8-3c13-11ee-ada2-f6ef532488df', 'd0d7a944-4d68-11ee-8e52-163f196f2d01', 'd0ffba3e-3f43-11ee-bbcc-3ec652d9135b', 'd170b820-d8e0-11ed-8a5e-7eb3022aafd7', 'd170b992-d8e0-11ed-8a5e-7eb3022aafd7', 'd170ba0a-d8e0-11ed-8a5e-7eb3022aafd7', 'd170ba78-d8e0-11ed-8a5e-7eb3022aafd7', 'd170badc-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bb40-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bba4-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bc08-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bc6c-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bcc6-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bd2a-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bd8e-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bde8-d8e0-11ed-8a5e-7eb3022aafd7', 'd170be4c-d8e0-11ed-8a5e-7eb3022aafd7', 'd170beb0-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bf0a-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bf6e-d8e0-11ed-8a5e-7eb3022aafd7', 'd170bfd2-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c036-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c090-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c0f4-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c14e-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c1b2-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c20c-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c270-d8e0-11ed-8a5e-7eb3022aafd7', 'd170c2d4-d8e0-11ed-8a5e-7eb3022aafd7', 'd385234e-358d-11ee-abeb-fe156b49c309', 'd3c6ecb4-67da-11ee-94e1-660920dc2c55', 'd54b035a-bd75-11ed-8570-f2f629e3b6b5', 'd5bda440-41ec-11ee-a0d1-c2d95376be84', 'd5bda5bc-41ec-11ee-a0d1-c2d95376be84', 'd5bda648-41ec-11ee-a0d1-c2d95376be84', 'd5bda6b6-41ec-11ee-a0d1-c2d95376be84', 'd5bda72e-41ec-11ee-a0d1-c2d95376be84', 'd5f96474-f950-11ed-afb8-e62f4848ef55', 'd705b018-4642-11ee-b962-e6127bb19385', 'd70f9602-e25a-11ec-a419-ca9a0ab92160', 'd728fde6-0a76-11ee-b990-fa63c7983957', 'd7ea49b6-ebfd-11ed-bdbb-a64f25f331a7', 'd84d25e2-5c49-11ee-a983-3a6a4fd51549', 'dabb1f76-56dd-11ee-a730-123a7cd7feb8', 'db5311ac-5794-11ee-a942-ba11c4fa0c1d', 'dc5a7ffc-29a7-11ed-ba3a-aa0c93599854', 'dd005440-64b6-11ee-94e1-660920dc2c55', 'e0795b1e-5c17-11ee-a983-3a6a4fd51549', 'e38129f0-8502-11ed-baf8-b295042e0991', 'e3affd56-c6ad-11ed-80c5-8aafd25d3da3', 'e46422b0-1b0b-11ee-a3eb-3e551551cbb4', 'e48115c6-1a40-11ee-b009-22af8d3ca085', 'e4ecaca4-025a-11ed-a29c-02a8f1fdcf0c', 'e7e94628-5b74-11ee-a983-3a6a4fd51549', 'e8aa41f8-f615-11ed-895e-4681e009663a', 'e937dc8e-83a6-11ed-bba1-92dd28c1288e', 'e937de14-83a6-11ed-bba1-92dd28c1288e', 'e937dea0-83a6-11ed-bba1-92dd28c1288e', 'ea88aea6-25a4-11ee-b092-8edc80ca2126', 'ea88b04a-25a4-11ee-b092-8edc80ca2126', 'ea88b0d6-25a4-11ee-b092-8edc80ca2126', 'ea88b13a-25a4-11ee-b092-8edc80ca2126', 'ea88b19e-25a4-11ee-b092-8edc80ca2126', 'ea88b202-25a4-11ee-b092-8edc80ca2126', 'ea88b266-25a4-11ee-b092-8edc80ca2126', 'ea8a1e26-8662-11ed-9640-66a7724c12ab', 'eab58586-8200-11ed-8a82-92dd28c1288e', 'eb945a10-5093-11ee-ada8-7ef2e53a0a4c', 'eba4e2ba-fb91-11ed-a30a-4abfda84734e', 'edd0d5ae-478f-11ee-a925-de638601213f', 'edd0d770-478f-11ee-a925-de638601213f', 'ee143948-6670-11ee-94e1-660920dc2c55', 'eebfcf84-1593-11ee-95c3-3ed88ba9e499', 'f23486d6-8caa-11ed-9c6b-2604804d0752', 'f28c8336-32b8-11ee-a212-8edc80ca2126', 'f31b776c-1ca6-11ee-845e-525e818ae952', 'f413814c-6381-11ee-ad98-26c88fb1f070', 'f4a93a76-56b6-11ed-b881-4eeadc686147', 'f4e22aec-fadb-11ed-b0eb-121ce766340c', 'f74192c6-4e4d-11ee-8905-127c1229a346', 'f7419456-4e4d-11ee-8905-127c1229a346', 'f741953c-4e4d-11ee-8905-127c1229a346', 'f8fff63e-2c2e-11ee-ae13-8edc80ca2126', 'fa92112e-5fac-11ee-ad98-26c88fb1f070', 'fb42e6d4-5903-11ee-a942-ba11c4fa0c1d', 'fb42e828-5903-11ee-a942-ba11c4fa0c1d', 'fc179eee-dcf6-11ed-bff3-cea1660bacf7', 'fc3d6354-cc66-11ed-9f1d-8aafd25d3da3', 'fe2b530c-d8db-11ed-8a5e-7eb3022aafd7', 'fe395122-575d-11ee-a942-ba11c4fa0c1d', 'feb076f8-5b9f-11ee-a983-3a6a4fd51549') and time >= '2023-10-11 10:00:00' and time <= '2023-10-11 11:00:00' group by time order by time")
index = 0
for res in res_list:
    time = res[0]
    in_bps = round((res[1]+res_list_back[index][1])/1024/1024, 2)
    out_bps = round((res[2]+res_list_back[index][2])/1024/1024, 2)
    print('time: {}, in: {}, out: {}'.format(time, in_bps, out_bps))

client.execute("INSERT INTO flow_snmp.flow_data_local_new (pipe_id, `time`, in_flow, out_flow, in_bps, out_bps) VALUES('20929d02-5a1d-11ee-bb54-4e35d34f6fb5', '2023-10-11 12:25:00', 0.0, 0.0, 444543974.0, 287963923.0)")
client.execute("ALTER TABLE flow_snmp.flow_data_local_new UPDATE in_bps = 444543974.0,out_bps = 287963923.0 WHERE pipe_id = '20929d02-5a1d-11ee-bb54-4e35d34f6fb5' and time = '2023-10-11 12:30:00'")


client.execute("select time, in_bps, out_bps from flow_snmp.flow_data_local_new WHERE pipe_id = '20929d02-5a1d-11ee-bb54-4e35d34f6fb5' and time >= '2023-10-10 00:20:00' order by time desc limit 3")
client.execute("select time, in_bps, out_bps from flow_snmp.flow_data_second_local WHERE pipe_id = '20929d02-5a1d-11ee-bb54-4e35d34f6fb5' and time >= '2023-10-10 00:20:00' order by time desc limit 3")

client.execute("select time, in_bps, out_bps from flow_snmp.flow_data WHERE pipe_id = '8cbcdaf2-68fe-11ee-ad98-26c88fb1f070' and time >= '2023-10-17 10:40' and time <= '2023-10-17 10:55:04'")

client.execute("select time, in_flow, out_flow, in_bps, out_bps from flow_snmp.flow_data WHERE pipe_id = 'ed3977c4-d57f-11eb-af9f-ea07a495bb82' and time >= '2022-07-01 00:00:00' and time <= '2022-08-01 00:00:00' order by in_bps desc limit 10;")
client.execute("select time, in_flow, out_flow, in_bps, out_bps from flow_snmp.flow_data WHERE pipe_id = 'ed3977c4-d57f-11eb-af9f-ea07a495bb82' and time >= '2022-07-01 00:00:00' and time <= '2022-08-01 00:00:00' order by out_bps desc limit 10;")



client.execute("select count(*) from flow_snmp.flow_data WHERE pipe_id = 'de60b252-4bff-11ec-b6a5-1ebe42b2cb1f' and time >= '2023-07-03 07:00:00' and time <= '2023-07-03 18:00:00';")
client.execute("ALTER TABLE flow_snmp.flow_data_local_new DELETE WHERE pipe_id = '29d3919c-c080-11ec-aed2-627563e71072' and time >= '2023-07-03 07:00:00' and time <= '2023-07-03 18:00:00';")

client.execute("ALTER TABLE flow_snmp.flow_data_local_new DELETE WHERE pipe_id = '9b445824-04e6-11ee-af70-4aae3864723e' and time >= '2023-07-01 07:00:00' and time <= '2023-07-02 19:00:00';")


client.execute("select toTimeZone(toStartOfFiveMinute(time), '') as time, sum(in_bps), sum(out_bps) from flow_snmp.flow_data where  (pipe_id in ('4eaf5570-f45d-11ed-bb3b-fac1491bd8ed',) and time >= '2023-06-01 00:00:00' and time < '2023-06-02 00:00:00') or (pipe_id in ('f69a5bfa-f45c-11ed-a219-e24846a47d7c',) and time >= '2023-06-01 00:00:00' and time < '2023-06-02 00:00:00') group by time order by time;")


client.execute("SELECT pipe_id, time, in_bps, out_bps FROM flow_snmp.flow_data where pipe_id in ('08c82f40-e609-11ec-b73c-1a0267b97f87', '2d1733dc-dcea-11ec-94f5-8e6add94d4e1') group by pipe_id")
client.execute("SELECT pipe_id, time, in_bps, out_bps FROM flow_snmp.flow_data where pipe_id in ('08c82f40-e609-11ec-b73c-1a0267b97f87', '2d1733dc-dcea-11ec-94f5-8e6add94d4e1') limit 10")

res = client.execute("SELECT out_bps FROM flow_snmp.flow_data where pipe_id  = 'cf4e2504-8102-11ed-a17a-66c490cc5739' and time >= '2023-04-01 00:00:00' and time < '2023-05-01 00:00:00' order by out_bps desc")
client.execute("SELECT count(*) FROM flow_snmp.flow_data where pipe_id  = 'fa07d7f4-8102-11ed-b44c-4229750f9d0c' and time >= '2023-04-01 00:00:00' and time < '2023-05-01 00:00:00'")


sql = "CREATE TABLE flow_snmp.flow_data_local_new_second (`pipe_id` String,`time` DateTime,`in_flow` Float64,`out_flow` Float64,`in_bps` Float64,`out_bps` Float64) ENGINE=Log"
ans = client.execute(sql)

client.execute("SHOW TABLES FROM  flow_snmp")
client.execute("SHOW databases")
client.execute("SHOW GRANTS")
client.execute("SELECT * FROM system.clusters")

client.execute("SELECT time, in_bps, out_bps FROM flow_snmp.flow_data where pipe_id  = '3a9a9ff8-b710-11ec-9bfc-8252cbfa8cce' and time >= '2022-04-13 17:45:01' and time < '2022-04-13 17:46:01' order by time")
# 查看表中数据条数以及空间占用情况
client.execute("SELECT sum(rows), formatReadableSize(sum(data_uncompressed_bytes)), formatReadableSize(sum(data_compressed_bytes)) from system.parts WHERE (database IN ('flow_snmp')) AND (table IN ('flow_data_local_new'))")
client.execute("SELECT pipe_id from flow_snmp.flow_data_local_new where time > '2021-05-01 12:00:00' order by time limit 50")
client.execute("SELECT pipe_id, COUNT(pipe_id) FROM flow_snmp.flow_data_local_new where time > '2021-07-06 11:00:00' group by pipe_id")
client.execute("SELECT pipe_id, COUNT(pipe_id) FROM flow_snmp.flow_data_local_new where time > '2020-10-06 11:00:00' and time > '2020-10-06 12:00:00' group by pipe_id")
client.execute("SHOW CREATE flow_snmp.flow_data_local_new")
client.execute("SELECT time, in_bps, out_bps from flow_snmp.flow_data WHERE pipe_id  = '06be7cce-c55d-11e9-82db-0242ac110002' and time > '2021-06-06 12:30:00' and time < '2021-07-06 12:30:00' order by time")

# 查看分区的数据分布
client.execute("select partition, sum(rows), formatReadableSize(sum(data_uncompressed_bytes)) from system.parts where table = 'flow_data_first_local' GROUP BY partition")
client.execute("select formatReadableSize(sum(data_uncompressed_bytes)), formatReadableSize(sum(data_compressed_bytes)) from system.parts where table = 'flow_data_local_new'")

client.execute("select count(*) from flow_snmp.flow_data")
client.execute("select count(*) from flow_snmp.flow_data_second_all")
client.execute("select count(*) from flow_snmp.flow_data_local_new")
client.execute("SELECT time, in_bps, out_bps FROM flow_snmp.flow_data_first_all where pipe_id  = '6c6d7e6a-2375-11e9-9cc0-0242ac110002' and time >= '2021-06-30 12:30:00' and time <= '2021-06-30 16:55:00' order by time")
client.execute("SELECT PARTITION,sum(rows),formatReadableSize (sum(data_uncompressed_bytes)),formatReadableSize (sum(data_compressed_bytes)) FROM system.parts WHERE (DATABASE IN ('flow_snmp')) AND (TABLE IN ('flow_data_first_local01')) GROUP BY PARTITION ORDER BY PARTITION ASC")


# 线上新建表结构
client.execute("CREATE TABLE flow_snmp.flow_data_first_local ON CLUSTER cluster_1shards_3replicas (`pipe_id` UUID,`time` DateTime,`in_flow` Float64,`out_flow` Float64,`in_bps` Float64,`out_bps` Float64) ENGINE=ReplicatedMergeTree ('/clickhouse/tables/{shard}/flow_data_first_local','{replica}') PARTITION BY toYYYYMM (time) ORDER BY (pipe_id,time) SETTINGS index_granularity=8192")
client.execute("CREATE TABLE flow_snmp.flow_data_first_all ON CLUSTER cluster_1shards_3replicas AS flow_snmp.flow_data_first_local ENGINE=Distributed ('cluster_1shards_3replicas','flow_snmp','flow_data_first_local',rand())")
client.execute("CREATE TABLE flow_snmp.flow_data_second_local ON CLUSTER cluster_1shards_3replicas (`pipe_id` UUID,`time` DateTime,`in_flow` Float64,`out_flow` Float64,`in_bps` Float64,`out_bps` Float64) ENGINE=ReplicatedMergeTree ('/clickhouse/tables/{shard}/flow_data_second_local','{replica}') PARTITION BY toYYYYMM (time) ORDER BY (pipe_id,time) SETTINGS index_granularity=8192")
client.execute("CREATE TABLE flow_snmp.flow_data_second_all ON CLUSTER cluster_1shards_3replicas AS flow_snmp.flow_data_second_local ENGINE=Distributed ('cluster_1shards_3replicas','flow_snmp','flow_data_second_local',rand())")

client.execute("INSERT INTO flow_snmp.flow_data_second_local (pipe_id, `time`, in_flow, out_flow, in_bps, out_bps) VALUES('e44bc7aa-6f6e-11ec-a6a9-b240c10b0009', '2021-07-05 15:55:00', 32674.0, 0.0, 0.0, 1.0)")
client.execute("select count(*) from flow_snmp.flow_data ")
client.execute("select * from flow_snmp.flow_data where pipe_id = '30aa2a22-0653-11ec-9ca9-0a0d265d6421' and time < '2022-07-01 11:00:00' order by time desc limit 3")
client.execute("select * from flow_snmp.flow_data where pipe_id = '06fc21a8-fc48-11ec-aa28-563722c44a2c' order by time desc limit 3")

client.execute("show create table flow_snmp.flow_data")
client.execute("SELECT * from flow_snmp.flow_data where pipe_id = '8a727b4c-3540-11ec-ab9c-ea82af98404f' and time > '2021-10-31 11:00:00' and time < '2021-10-31 12:00:00'")
# client.execute("ALTER TABLE flow_snmp.flow_data_first_local DROP PARTITION '202107'")
client.execute("select partition, sum(rows), formatReadableSize(sum(data_uncompressed_bytes)) from system.parts where table = 'flow_data_local_new' GROUP BY partition")
# client.execute("DROP TABLE flow_snmp.flow_data_first_local01 ON CLUSTER cluster_1shards_3replicas")


client.execute("select distinct pipe_id from flow_snmp.flow_data where time > '2022-08-12 00:00:00' and time < '2022-08-12 01:00:00'")
client.execute("select pipe_id from flow_snmp.flow_data where time > '2022-08-12 00:00:00' and time < '2022-08-12 01:00:00' group by pipe_id")
client.execute("select * from flow_snmp.flow_data_second_all where pipe_id = '2dac62a1-1fb3-40d3-af4b-74c260ec1e8a' order by time desc limit 3")

pipe_list = ['2891320e-f1c1-11e7-96f3-0242ac110002','eca9cadc-9dea-11e7-b9b0-0242ac110002','16c5a4ca-bd98-11e9-ad3c-0242ac110002','c169caa0-f1c0-11e7-9908-0242ac110002','2891320e-f1c1-11e7-96f3-0242ac110002','a9cd68f0-eb30-11e9-a8e3-0242ac110002','c169caa0-f1c0-11e7-9908-0242ac110002','0940b37e-c8ca-11ea-a47a-0242ac110002','74097ee4-04cb-11e9-9a97-0242ac110002','a66bfaec-6954-11ec-a237-a6cf2cd47dab','b150a32e-8bb7-11e7-be82-0242ac110002','484ec8e0-4196-11e6-bf47-0050569b1b91','b55fdbfc-c32f-11e6-8ad6-0242ac110002','1deab2ee-a6ea-11e6-8a77-0242ac110002','e2ceb6ce-f1c0-11e7-ad1b-0242ac110002','484ec8e0-4196-11e6-bf47-0050569b1b91','88c3c156-f1c0-11e7-b540-0242ac110002','e2ceb6ce-f1c0-11e7-ad1b-0242ac110002','2bad4fb0-9b36-11ea-9258-e6b573eee7ea']
for pipe in pipe_list:
    res = client.execute(
        "select * from flow_snmp.flow_data where pipe_id = '{}' order by time limit 1".format(pipe))
    print("pipe : {} , data : {}".format(pipe, res))
    # res = client.execute("select count(*) from flow_snmp.flow_data where pipe_id = '{}' and time >= '2020-07-01 00:00:00' and time < '2020-10-01 00:00:00'".format(pipe))
    if res[0][0] >= 1:
        print(pipe)


res = client.execute("select pipe_id, count(0) as num from flow_data where time >= '' and time < '' and pipe_id = '';")

client.execute("select time, in_bps, out_bps from flow_snmp.flow_data where pipe_id = '5803da3a-cc47-11ed-8ce9-ba7dff90fbd8' and time > '2023-03-29 20:00:00' order by time limit 3")
client.execute("select time, in_bps, out_bps from flow_snmp.flow_data where pipe_id = '0dd2350a-0d1a-11ea-9a62-0242ac110002' and time > '2023-03-29 15:39:00' order by time limit 3")


res = client.execute("select time, in_flow, out_flow from flow_snmp.flow_data where pipe_id = 'fc9a795e-f312-11ed-8dd4-b68111c315ad' and time >= '2023-05-17 00:00:00' and time < '2023-05-18 00:00:00' order by time")
temp_in = 0
temp_out = 0
for r in res:
    in_flow = r[1]
    out_flow = r[2]
    print("{},{},{}".format(r[0], in_flow-temp_in, out_flow-temp_out))
    temp_in = in_flow
    temp_out = out_flow





from datetime import datetime, timedelta
from random import randint
start_time = datetime(2022, 8, 3, 2, 00, 00)
end_time = datetime(2022, 8, 12, 11, 00, 00)
ck_data_list = []
FLOW_TABLE_NAME = "flow_data_local_new"
while start_time < end_time:
    ck_data_list.append(['8a67d02a-fb79-11ec-a4f8-0a6807bdebf2', start_time, int(randint(400, 800)/100*1000*1000), int(randint(800, 1300)/100*1000*1000)])
    start_time += timedelta(seconds=300)


insert_sql = f"insert into {CK_DB_ANME}.{FLOW_TABLE_NAME} (pipe_id, time, in_bps, out_bps) VALUES"
client.execute(insert_sql, ck_data_list)


client.execute("select * from flow_snmp.flow_data where time = '2022-09-01 10:25:00' and pipe_id = 'f4a29bf2-2827-11ed-9830-aa0c93599854'")
client.execute("select * from flow_snmp.flow_data_second_all where time = '2022-09-01 10:25:00' and pipe_id = 'f4a29bf2-2827-11ed-9830-aa0c93599854'")